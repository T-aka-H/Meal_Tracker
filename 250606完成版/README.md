# 食事記録アプリ - Supabase版

このアプリケーションは、Supabaseをバックエンドとして使用した食事記録管理システムです。
複数のユーザーが自分の食事を記録し、統計情報を確認することができます。

## 機能

- 複数ユーザーのサポート
- 食事記録の追加、編集、削除
- 日付、時間、食事タイプ、料理名、カロリー、場所、メモの記録
- ユーザーごとの統計情報（総記録数、今週の記録数、平均カロリー、最後の食事）
- データのCSVエクスポート（ユーザー別・全ユーザー）
- レスポンシブデザイン（スマートフォン対応）

## セットアップ手順

1. Supabaseでプロジェクトを作成
   - [Supabase](https://supabase.com)にアクセスし、新しいプロジェクトを作成
   - `schema.sql`の内容をSQLエディタにコピー&ペーストして実行

2. プロジェクト設定の取得
   - Project Settings > API から以下の情報を取得:
     - Project URL
     - anon/public key (APIキー)

3. アプリケーションの起動
   - `index.html`をブラウザで開く
   - Supabase設定セクションにProject URLとAPIキーを入力
   - 「接続」ボタンをクリック

## 使い方

1. ユーザー管理
   - 「新規ユーザー追加」ボタンからユーザーを作成
   - ドロップダウンメニューからユーザーを選択

2. 食事の記録
   - フォームに必要事項を入力
   - 必須項目: 日付、時間、食事タイプ、料理名
   - オプション項目: カロリー、場所、メモ

3. 記録の管理
   - 各記録の編集・削除が可能
   - 記録一覧は日時順に表示

4. データのエクスポート
   - 「データをダウンロード」: 現在のユーザーの記録をCSVでダウンロード
   - 「全ユーザーデータダウンロード」: 全ユーザーの記録をCSVでダウンロード

## 技術スタック

- フロントエンド
  - HTML5
  - CSS3 (レスポンシブデザイン)
  - JavaScript (ES6+)
  - Supabase JavaScript Client

- バックエンド
  - Supabase (PostgreSQL)
  - Row Level Security (RLS)
  - データベーストリガー
  - インデックス最適化

## セキュリティ注意事項

このデモアプリケーションでは、簡単のために全ての操作を匿名ユーザーに許可しています。
実運用環境では、適切な認証・認可の設定を行うことを強く推奨します。

## ライセンス

MIT License 

# 食事記録アプリ プロキシサーバー

このプロキシサーバーは、食事記録アプリのAI分析機能（Cohere API）を提供します。

## セットアップ手順

1. 必要な依存関係をインストール:
```bash
npm install
```

2. 環境変数の設定:
`.env`ファイルを作成し、以下の内容を設定してください：
```
PORT=8080
COHERE_API_KEY=your_cohere_api_key_here
ALLOWED_ORIGIN=http://localhost:5500
```

- `PORT`: サーバーのポート番号（デフォルト: 8080）
- `COHERE_API_KEY`: CohereのAPIキー（[Cohereダッシュボード](https://dashboard.cohere.ai/)から取得）
- `ALLOWED_ORIGIN`: クライアントアプリケーションのオリジン

3. サーバーの起動:
```bash
# 開発モード（自動再起動あり）
npm run dev

# 本番モード
npm start
```

## エンドポイント

### ヘルスチェック
- `GET /health`
- サーバーの状態を確認

### 食事分析
- `POST /cohere-analyze`
- リクエストボディ:
  ```json
  {
    "prompt": "分析用のテキスト",
    "language": "ja"または"en"
  }
  ```
- レスポンス:
  ```json
  {
    "text": "生成されたアドバイス",
    "language": "使用された言語"
  }
  ```

## エラーハンドリング

エラーが発生した場合、以下の形式でレスポンスが返されます：
```json
{
  "error": "エラーメッセージ",
  "details": "詳細なエラー情報"
}
``` 